(()=>{var e={174:()=>{const e=document.querySelector("#upload-file"),t=document.querySelector(".img-upload__preview > img"),o=document.querySelectorAll(".effects__preview"),n=["jpeg","png","gif","jpg"];e.addEventListener("change",(r=>{const c=e.files[0],s=c.name.toLowerCase();if(n.some((e=>s.endsWith(e)))){const e=new FileReader;e.addEventListener("load",(()=>{t.src=e.result,t.width="600",t.height="600",t.style.backgroundSize="cover",o.forEach((t=>{t.style.backgroundImage=`url(${e.result})`}))})),e.readAsDataURL(c)}}))},247:()=>{const e=document.querySelector(".text__hashtags"),t=document.querySelector(".text__description"),o=(document.querySelector("#upload-submit"),document.querySelector(".img-upload__form"),e=>{e.addEventListener("keydown",(t=>{"Esc"!==t.key&&"Escape"!==t.key||(t.stopPropagation(),e.blur())}))});o(e),o(t),e.addEventListener("input",(()=>{e.setCustomValidity("");let t=e.value.trim().toLowerCase(),o=t.split(" ");o.some((e=>"#"!==e[0]))?(e.setCustomValidity("Хэш-тег должен начинаться с символа #"),e.style.boxShadow="0 0 8px red"):e.style.boxShadow="",o.some((e=>"#"===e))?(e.setCustomValidity("Хеш-тег не может состоять только из одной решетки (#)"),e.style.boxShadow="0 0 8px red"):e.style.boxShadow="",o.some((e=>e.length>20))?(e.setCustomValidity("Максимальная длина хэш-тега 20 символов, включая символ #"),e.style.boxShadow="0 0 8px red"):e.style.boxShadow="",o.length>5?(e.setCustomValidity("Нельзя указать больше пяти хэш-тегов"),e.style.boxShadow="0 0 8px red"):e.style.boxShadow="",o.some((e=>e.indexOf("#",1)>=0))?(e.setCustomValidity("Хэш-теги должны разделяться пробелами"),e.style.boxShadow="0 0 8px red"):e.style.boxShadow="",o.filter(((e,t)=>o.indexOf(e)!==t)).length>0?(e.setCustomValidity("Один и тот же хэш-тег не может быть использован дважды"),e.style.boxShadow="0 0 8px red"):e.style.boxShadow="",(e=>/[!@$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e))(t)?(e.setCustomValidity("Строка после символа # должна содержать только буквы и цифры"),e.style.boxShadow="0 0 8px red"):e.style.boxShadow=""})),t.addEventListener("input",(function(){textarea.value.length>140?(textarea.setCustomValidity("Текст  не должен содержать более 140 символов"),e.style.boxShadow="0 0 8px red"):(textarea.setCustomValidity(""),e.style.boxShadow="")}))}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var c=t[n]={exports:{}};return e[n](c,c.exports,o),c.exports}(()=>{"use strict";const e=e=>"Escape"===e.key,t=document.querySelector(".big-picture"),n=document.querySelector("body"),r=t.querySelector(".social__comments"),c=document.querySelector("#comment").content.querySelector(".social__comment"),s=document.querySelector(".big-picture__cancel"),l=document.querySelector(".comments-loader"),i=document.querySelector(".social__comment-count"),a=document.querySelector(".social__footer-text"),d=document.querySelector(".social__footer-btn"),u=document.querySelector(".likes-count");let m,y=[],p=5;const v=e=>{r.textContent="",e.slice(0,p).forEach((e=>{const t=(e=>{const t=c.cloneNode(!0);return t.querySelector(".social__picture").src=e.avatar,t.querySelector(".social__picture").alt=e.name,t.querySelector(".social__text").textContent=e.message,t})(e);r.appendChild(t)})),m=Array.from(t.querySelectorAll(".social__comment")),y.length==m.length&&(l.style.display="none"),i.textContent=`${m.length} из ${y.length} коментариев`},S=()=>{t.classList.add("hidden"),n.classList.remove("modal-open"),s.removeEventListener("click",S),document.removeEventListener("keydown",e),p=5,m=0,l.style.display="block"};u.addEventListener("click",(()=>{let e=u.textContent;u.classList.contains("likes-count--active")?(u.textContent=Number(e)-1,u.classList.remove("likes-count--active")):(u.classList.toggle("likes-count--active"),u.textContent=Number(e)+1)})),d.addEventListener("click",(()=>{const e={id:1005,avatar:"img/avatar-6.svg",message:a.value,name:"Имя пользователя"};y.unshift(e),a.value="",v(y),console.log(e)})),l.addEventListener("click",(()=>{r.textContent="",p+=5,v([...y].slice(0,p))}));const _=document.querySelector("#picture").content.querySelector(".picture"),g=document.querySelector(".pictures"),h=document.createDocumentFragment(),x=o=>{o.forEach((o=>{const r=(({url:e,likes:t,comments:o,description:n})=>{const r=_.cloneNode(!0);return r.querySelector(".picture__img").src=e,r.querySelector(".picture__comments").textContent=o.length,r.querySelector(".picture__likes").textContent=t,r})(o);h.appendChild(r),((o,{url:r,likes:c,comments:l,description:i})=>{o.addEventListener("click",(o=>{o.preventDefault(),((o,r,c,l)=>{y=c,n.classList.add("modal-open"),t.querySelector(".big-picture__img > img").src=o,t.querySelector(".likes-count").textContent=r,t.querySelector(".social__caption").textContent=l,v(c),c.length,s.addEventListener("click",S),document.addEventListener("keydown",(t=>{e(t)&&S()})),t.classList.remove("hidden")})(r,c,l,i)}))})(r,o)})),g.appendChild(h)},q=[{name:"none",style:"none",min:0,max:100,step:1,unit:""},{name:"chrome",style:"grayscale",min:0,max:1,step:.1,unit:""},{name:"sepia",style:"sepia",min:0,max:1,step:.1,unit:""},{name:"marvin",style:"invert",min:0,max:100,step:1,unit:"%"},{name:"phobos",style:"blur",min:0,max:3,step:.1,unit:"px"},{name:"heat",style:"brightness",min:1,max:3,step:.1,unit:""}],f=document.querySelector(".img-upload__preview img"),L=document.querySelector(".effects"),b=document.querySelector(".effect-level__slider"),E=document.querySelector(".img-upload__effect-level"),k=document.querySelector(".effect-level__value"),w=q[0];let C=w;const V=()=>C===w,N=()=>{E.classList.add("hidden")};noUiSlider.create(b,{range:{min:w.min,max:w.max},start:w.max,step:w.step,connect:"lower"}),N(),L.addEventListener("change",(e=>{e.target.classList.contains("effects__radio")&&(C=q.find((t=>t.name===e.target.value)),f.className=`effects__preview--${C.name}`,b.noUiSlider.updateOptions({range:{min:C.min,max:C.max},step:C.step,start:C.max}),V()?N():E.classList.remove("hidden"))})),b.noUiSlider.on("update",(()=>{const e=b.noUiSlider.get();V()?f.style.filter=w.style:f.style.filter=`${C.style}(${e}${C.unit})`,k.value=e}));const $=document.querySelector(".img-upload__overlay"),A=document.querySelector("#upload-file"),T=document.querySelector("body"),D=document.querySelector("#upload-cancel"),O=document.querySelector(".scale__control--value"),U=document.querySelector(".scale__control--smaller"),j=document.querySelector(".scale__control--bigger"),P=document.querySelector(".img-upload__preview > img"),F=()=>{$.classList.add("hidden"),T.classList.remove("modal-open"),P.style.filter="",P.style="transform: scale(1.00)",A.value="",E.classList.add("hidden"),f.className=""};A.addEventListener("change",(e=>{$.classList.remove("hidden"),T.classList.add("modal-open"),O.value="100%";const t=e.target.files[0];console.log(t),D.addEventListener("click",(()=>{F()})),document.addEventListener("keydown",(e=>{"Esc"!==e.key&&"Escape"!==e.key||(F(),e.stopPropagation())}))}));const G=e=>{let t=parseInt(O.value);t+=25*("bigger"===e?1:-1),t>=100?t=100:t<=25&&(t=25),O.value=t+"%",t/=100,P.style.transform=`scale(${t})`};j.addEventListener("click",(()=>{G("bigger")})),U.addEventListener("click",(()=>{G("smaller")})),o(247);const I={GET:"https://23.javascript.htmlacademy.pro/kekstagram/data",POST:"https://reqres.in/api/users"},M=(e,t,o,n)=>{fetch(I[o],{method:o,body:n}).then((e=>e.json())).then((t=>{e(t)})).catch((()=>t()))},R=document.querySelector(".img-upload__form"),z=document.querySelector("#error").content.querySelector(".error"),W=document.querySelector("#success").content.querySelector(".success"),B=document.querySelector("body"),H=()=>{let t=W.cloneNode(!0),o=t.querySelector(".success__button");R.reset();const n=()=>{t.remove(),o.removeEventListener("click",n),document.removeEventListener("keydown",n)};o.addEventListener("click",n),document.addEventListener("keydown",(t=>{e(t)&&n()})),F(),B.appendChild(t)},J=()=>{let t=z.cloneNode(!0),o=t.querySelector(".error__button");const n=()=>{t.remove(),o.removeEventListener("click",n),document.removeEventListener("keydown",closeSuccessSection)};o.addEventListener("click",n),document.addEventListener("keydown",(t=>{e(t)&&n()})),F(),B.appendChild(t)};R.addEventListener("submit",(e=>{e.preventDefault();const t=new FormData(e.target);console.log("форма аля улю"),M(H,J,"POST",t)})),o(174);const K=document.querySelector("#error").content.querySelector(".error"),Q=document.querySelector("body"),X=document.querySelector(".img-filters"),Y=X.querySelectorAll("button");let Z=[];const ee={"filter-default":()=>x(Z.slice(0,25)),"filter-discussed":()=>x(Z.slice().sort(((e,t)=>t.comments.length-e.comments.length))),"filter-random":()=>x((e=>{for(let t=e.length-1;t>0;t--){const o=Math.floor(Math.random()*(t+1));[e[t],e[o]]=[e[o],e[t]]}return e})(Z.slice()).slice(0,10))};M((e=>{Z=e,x(Z.slice()),X.classList.remove("img-filters--inactive")}),(e=>{let t=K.cloneNode(!0),o=t.querySelector(".error__button");t.querySelector(".error__title").textContent="Проблема с сервером",o.textContent="Перезагрузить сайт";const n=()=>{window.location.reload(),t.remove(),o.removeEventListener("click",n)};o.addEventListener("click",n),Q.appendChild(t)}),"GET");const te=((e,t)=>{let o;return(...e)=>{o&&clearTimeout(o),o=setTimeout((()=>{(e=>{e.target.classList.contains("img-filters__button")&&((()=>{let e=document.querySelectorAll(".picture");e&&e.forEach((e=>{e.remove()}))})(),ee[e.target.id]())})(...e),o=null}),300)}})();X.addEventListener("click",te),X.addEventListener("click",(e=>{e.target.classList.contains("img-filters__button")&&(Y.forEach((e=>{e.classList.remove("img-filters__button--active")})),e.target.classList.add("img-filters__button--active"))}))})()})();
//# sourceMappingURL=main.bundle.js.map